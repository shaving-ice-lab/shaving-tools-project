# å®æ—¶æ¸¸æˆå¸§ç‡ç›‘æ§å·¥å…· - å¼€å‘æ–‡æ¡£

> **é¡¹ç›®ç¼–å·**: 07  
> **é¡¹ç›®ç›®å½•**: `apps/game-fps-monitor`  
> **ä¼˜å…ˆçº§**: P1ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰  
> **çŠ¶æ€**: âœ… å¼€å‘å®Œæˆ  
> **é¢„è®¡å·¥æœŸ**: 2-3å‘¨  
> **æŠ€æœ¯éš¾åº¦**: â­â­â­â­â˜†

---

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

å®æ—¶æ¸¸æˆå¸§ç‡ç›‘æ§å·¥å…·æ˜¯ä¸€å¥—åŒ…å« **Android App** å’Œ **æ¡Œé¢ç«¯å±•ç¤ºç¨‹åº** çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚Android Appè´Ÿè´£å®æ—¶é‡‡é›†æ¸¸æˆæ€§èƒ½æ•°æ®ï¼ˆå¸§ç‡ã€CPU/GPUå ç”¨ã€æ¸©åº¦ã€åŠŸè€—ç­‰ï¼‰ï¼Œæ¡Œé¢ç«¯è´Ÿè´£æ¥æ”¶ã€å­˜å‚¨å’Œå¯è§†åŒ–å±•ç¤ºæ•°æ®ã€‚

### ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      æ— çº¿/æœ‰çº¿ä¼ è¾“      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Android App   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚    æ¡Œé¢ç«¯ç¨‹åº    â”‚
â”‚  (æ•°æ®é‡‡é›†ç«¯)    â”‚    WebSocket / ADB      â”‚   (æ•°æ®å±•ç¤ºç«¯)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒä»·å€¼

1. **æ— Rootå®æ—¶å¸§ç‡ç›‘æ§**: é€šè¿‡ç³»ç»ŸAPIè·å–å¸§ç‡æ•°æ®
2. **æ‚¬æµ®çª—æ˜¾ç¤º**: æ¸¸æˆä¸­å®æ—¶æŸ¥çœ‹æ€§èƒ½æ•°æ®
3. **æ¡Œé¢ç«¯å¤§å±å±•ç¤º**: ä¸“ä¸šæ•°æ®å¯è§†åŒ–ä¸æŠ¥å‘Šç”Ÿæˆ
4. **å¤šç§ä¼ è¾“æ–¹å¼**: æ”¯æŒWiFiæ— çº¿ä¼ è¾“å’ŒUSBæœ‰çº¿ä¼ è¾“

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### Android App

| ç±»åˆ«         | æŠ€æœ¯é€‰å‹                  | è¯´æ˜                |
| ------------ | ------------------------- | ------------------- |
| **å¼€å‘è¯­è¨€** | Kotlin                    | Androidç°ä»£å¼€å‘è¯­è¨€ |
| **UIæ¡†æ¶**   | Jetpack Compose           | å£°æ˜å¼UIæ¡†æ¶        |
| **æ¶æ„**     | MVVM + Clean Architecture | æ¸…æ™°åˆ†å±‚            |
| **ä¾èµ–æ³¨å…¥** | Hilt                      | Googleå®˜æ–¹DIæ¡†æ¶    |
| **æ•°æ®åº“**   | Room                      | SQLite ORM          |
| **å›¾è¡¨**     | Vico                      | Composeå›¾è¡¨åº“       |
| **ç½‘ç»œ**     | OkHttp + WebSocket        | å®æ—¶æ•°æ®ä¼ è¾“        |
| **æœ€ä½ç‰ˆæœ¬** | Android 8.0 (API 26)      | è¦†ç›–95%+è®¾å¤‡        |

### æ¡Œé¢ç«¯ç¨‹åº

| ç±»åˆ«         | æŠ€æœ¯é€‰å‹              | è¯´æ˜             |
| ------------ | --------------------- | ---------------- |
| **æ¡†æ¶**     | Electron + React      | è·¨å¹³å°æ¡Œé¢åº”ç”¨   |
| **UIåº“**     | TailwindCSS + shadcn  | ç°ä»£UIç»„ä»¶       |
| **å›¾è¡¨**     | Recharts / Chart.js   | æ•°æ®å¯è§†åŒ–       |
| **é€šä¿¡**     | WebSocket + ADB       | æ— çº¿/æœ‰çº¿ä¼ è¾“    |
| **æ•°æ®å­˜å‚¨** | SQLite (better-sqlite3) | æœ¬åœ°æ•°æ®æŒä¹…åŒ– |

---

## ğŸ¯ åŠŸèƒ½æ¨¡å—

### Android App åŠŸèƒ½

#### 1. å®æ—¶æ€§èƒ½ç›‘æ§

- **å¸§ç‡(FPS)**: é€šè¿‡Choreographerè·å–å®æ—¶å¸§ç‡
- **å¸§æ—¶é—´(Frame Time)**: æ¯å¸§æ¸²æŸ“æ—¶é—´ï¼Œæ£€æµ‹å¡é¡¿
- **CPUå ç”¨ç‡**: è¯»å–/proc/statè·å–CPUä½¿ç”¨ç‡
- **GPUå ç”¨ç‡**: é€šè¿‡å‚å•†APIæˆ–dumpsysè·å–
- **å†…å­˜å ç”¨**: åº”ç”¨å’Œç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µ
- **ç”µæ± æ¸©åº¦**: è®¾å¤‡æ¸©åº¦ç›‘æ§
- **åŠŸè€—ä¼°ç®—**: åŸºäºç”µæµè®¡ç®—å®æ—¶åŠŸè€—

#### 2. æ‚¬æµ®çª—æ˜¾ç¤º

- å¯æ‹–åŠ¨æ‚¬æµ®çª—
- ç®€æ´/è¯¦ç»†ä¸¤ç§æ˜¾ç¤ºæ¨¡å¼
- é€æ˜åº¦å¯è°ƒ
- ä½ç½®è®°å¿†

#### 3. æ•°æ®è®°å½•

- å¸§ç‡æ›²çº¿å®æ—¶è®°å½•
- å¡é¡¿å¸§æ ‡è®°(Jank Frame)
- æµ‹è¯•ä¼šè¯ç®¡ç†
- æœ¬åœ°æ•°æ®å­˜å‚¨

#### 4. æ•°æ®ä¼ è¾“

- **WiFiæ¨¡å¼**: WebSocketå®æ—¶æ¨é€
- **USBæ¨¡å¼**: ADBç«¯å£è½¬å‘
- è‡ªåŠ¨é‡è¿æœºåˆ¶
- æ•°æ®å‹ç¼©ä¼ è¾“

#### 5. æŠ¥å‘Šç”Ÿæˆ

- ä¸€é”®ç”Ÿæˆæ¸¸æˆæ€§èƒ½æŠ¥å‘Š
- å¸§ç‡ç¨³å®šæ€§åˆ†æ
- å¡é¡¿ç‡ç»Ÿè®¡
- æ¸©åº¦åŠŸè€—æ›²çº¿
- æ”¯æŒå¯¼å‡ºåˆ†äº«

### æ¡Œé¢ç«¯åŠŸèƒ½

#### 1. è®¾å¤‡è¿æ¥

- è‡ªåŠ¨å‘ç°å±€åŸŸç½‘è®¾å¤‡
- USBè®¾å¤‡æ£€æµ‹(ADB)
- è¿æ¥çŠ¶æ€ç›‘æ§
- å¤šè®¾å¤‡æ”¯æŒ

#### 2. å®æ—¶æ•°æ®å±•ç¤º

- å¤§å±å®æ—¶å¸§ç‡æ›²çº¿
- å¤šæŒ‡æ ‡åŒæ—¶æ˜¾ç¤º
- å¡é¡¿å¸§é«˜äº®æ ‡è®°
- å®æ—¶ç»Ÿè®¡é¢æ¿

#### 3. å†å²æ•°æ®ç®¡ç†

- æµ‹è¯•ä¼šè¯åˆ—è¡¨
- æ•°æ®ç­›é€‰è¿‡æ»¤
- å¤šä¼šè¯å¯¹æ¯”

#### 4. æ•°æ®å¯è§†åŒ–

- å¸§ç‡åˆ†å¸ƒç›´æ–¹å›¾
- æ¸©åº¦/åŠŸè€—è¶‹åŠ¿å›¾
- æ€§èƒ½å¯¹æ¯”é›·è¾¾å›¾
- å¡é¡¿æ—¶é—´è½´

#### 5. æŠ¥å‘Šå¯¼å‡º

- PDFæŠ¥å‘Šç”Ÿæˆ
- Excelæ•°æ®å¯¼å‡º
- å›¾ç‰‡å¯¼å‡º

---

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

### Android App

```text
apps/game-fps-monitor/
â”œâ”€â”€ android/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ src/main/
â”‚   â”‚   â”‚   â”œâ”€â”€ java/com/shavingtools/fpsmonitor/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FpsMonitorApp.kt
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MainActivity.kt
â”‚   â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ local/
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FpsDatabase.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ dao/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ remote/
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ WebSocketClient.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ repository/
â”‚   â”‚   â”‚   â”‚   â”‚       â””â”€â”€ PerformanceRepository.kt
â”‚   â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FrameData.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PerformanceSnapshot.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ TestSession.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ usecase/
â”‚   â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ CollectFpsUseCase.kt
â”‚   â”‚   â”‚   â”‚   â”‚       â””â”€â”€ TransmitDataUseCase.kt
â”‚   â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FpsCollectorService.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ OverlayService.kt
â”‚   â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ overlay/
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ OverlayView.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HomeScreen.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MonitorScreen.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HistoryScreen.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SettingsScreen.kt
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ viewmodel/
â”‚   â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ di/
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ res/
â”‚   â”‚   â”‚   â””â”€â”€ AndroidManifest.xml
â”‚   â”‚   â””â”€â”€ build.gradle.kts
â”‚   â”‚
â”‚   â”œâ”€â”€ gradle/
â”‚   â”œâ”€â”€ build.gradle.kts
â”‚   â””â”€â”€ settings.gradle.kts
```

### æ¡Œé¢ç«¯

```text
apps/game-fps-monitor/
â”œâ”€â”€ desktop/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts           # Electronä¸»è¿›ç¨‹
â”‚   â”‚   â”‚   â”œâ”€â”€ adb.ts             # ADBè¿æ¥ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ websocket.ts       # WebSocketæœåŠ¡å™¨
â”‚   â”‚   â”‚   â””â”€â”€ database.ts        # SQLiteæ•°æ®åº“
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ renderer/
â”‚   â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DevicePanel.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FpsChart.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ StatsCard.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SessionList.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ History.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Settings.tsx
â”‚   â”‚   â”‚   â””â”€â”€ hooks/
â”‚   â”‚   â”‚       â”œâ”€â”€ useWebSocket.ts
â”‚   â”‚   â”‚       â””â”€â”€ useAdb.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ preload/
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ electron-builder.json
â”‚   â””â”€â”€ tsconfig.json
```

---

## ğŸ“¡ æ•°æ®ä¼ è¾“åè®®

### WebSocketåè®®ï¼ˆæ— çº¿ä¼ è¾“ï¼‰

```typescript
// è¿æ¥å»ºç«‹
// Appä½œä¸ºClientè¿æ¥æ¡Œé¢ç«¯Server
// ws://desktop_ip:8765

// æ•°æ®åŒ…æ ¼å¼
interface PerformancePacket {
  type: 'frame' | 'snapshot' | 'session_start' | 'session_end';
  timestamp: number;
  deviceId: string;
  data: FrameData | PerformanceSnapshot | SessionInfo;
}

interface FrameData {
  fps: number;
  frameTime: number;      // ms
  jank: boolean;          // æ˜¯å¦å¡é¡¿å¸§
}

interface PerformanceSnapshot {
  fps: number;
  avgFps: number;
  minFps: number;
  maxFps: number;
  cpuUsage: number;       // ç™¾åˆ†æ¯”
  gpuUsage: number;       // ç™¾åˆ†æ¯”
  memoryUsage: number;    // MB
  temperature: number;    // æ‘„æ°åº¦
  power: number;          // mW
  jankCount: number;
  jankRate: number;       // ç™¾åˆ†æ¯”
}
```

### ADBä¼ è¾“ï¼ˆæœ‰çº¿ä¼ è¾“ï¼‰

```bash
# ç«¯å£è½¬å‘
adb forward tcp:8765 tcp:8765

# ç„¶åé€šè¿‡localhost:8765è¿›è¡ŒWebSocketé€šä¿¡
# ä¸æ— çº¿æ¨¡å¼ä½¿ç”¨ç›¸åŒçš„åè®®
```

---

## ğŸ“‹ å¼€å‘ä»»åŠ¡æ¸…å• (TODO List)

### Android App

#### åŸºç¡€æ¶æ„
- [x] åˆ›å»ºAndroidé¡¹ç›®ï¼ˆKotlin + Jetpack Composeï¼‰
- [x] é…ç½®Gradleä¾èµ–ï¼ˆComposeã€Hiltã€Roomã€OkHttpï¼‰
- [x] è®¾ç½®MVVMåˆ†å±‚æ¶æ„
- [x] é…ç½®Hiltä¾èµ–æ³¨å…¥

#### æ€§èƒ½æ•°æ®é‡‡é›†
- [x] å®ç°Choreographerå¸§ç‡é‡‡é›†
- [x] å®ç°CPUå ç”¨ç‡é‡‡é›†ï¼ˆ/proc/statè§£æï¼‰
- [x] å®ç°GPUå ç”¨ç‡é‡‡é›†ï¼ˆdumpsys gpuï¼‰
- [x] å®ç°å†…å­˜å ç”¨é‡‡é›†
- [x] å®ç°æ¸©åº¦æ•°æ®é‡‡é›†
- [x] å®ç°åŠŸè€—ä¼°ç®—ç®—æ³•
- [x] å®ç°å¡é¡¿å¸§æ£€æµ‹ï¼ˆJank Frame Detectionï¼‰

#### æ‚¬æµ®çª—æœåŠ¡
- [x] å®ç°OverlayServiceï¼ˆTYPE_APPLICATION_OVERLAYï¼‰
- [x] å®ç°æ‚¬æµ®çª—UIï¼ˆComposeæˆ–è‡ªå®šä¹‰Viewï¼‰
- [x] å®ç°æ‚¬æµ®çª—æ‹–åŠ¨åŠŸèƒ½
- [x] å®ç°ç®€æ´/è¯¦ç»†æ¨¡å¼åˆ‡æ¢
- [x] å®ç°é€æ˜åº¦è°ƒèŠ‚
- [x] å®ç°ä½ç½®è®°å¿†

#### æ•°æ®å­˜å‚¨
- [x] è®¾è®¡Roomæ•°æ®åº“Schema
- [x] å®ç°FrameRecordè¡¨
- [x] å®ç°TestSessionè¡¨
- [x] å®ç°Repositoryå±‚

#### æ•°æ®ä¼ è¾“
- [x] å®ç°WebSocketå®¢æˆ·ç«¯
- [x] å®ç°è‡ªåŠ¨å‘ç°æ¡Œé¢ç«¯ï¼ˆUDPå¹¿æ’­ï¼‰
- [x] å®ç°ADBæ¨¡å¼æ£€æµ‹
- [x] å®ç°æ–­çº¿é‡è¿æœºåˆ¶
- [x] å®ç°æ•°æ®å‹ç¼©ä¼ è¾“

#### UIå¼€å‘
- [x] é¦–é¡µç•Œé¢ï¼ˆè¿æ¥çŠ¶æ€ã€å¿«æ·æ“ä½œï¼‰
- [x] ç›‘æ§ç•Œé¢ï¼ˆå®æ—¶æ•°æ®ã€å¸§ç‡æ›²çº¿ï¼‰
- [x] å†å²è®°å½•ç•Œé¢
- [x] è®¾ç½®ç•Œé¢ï¼ˆæ‚¬æµ®çª—ã€ä¼ è¾“ã€é‡‡æ ·ç‡ï¼‰

#### æŠ¥å‘Šç”Ÿæˆ
- [x] å®ç°æ€§èƒ½æŠ¥å‘Šæ•°æ®æ¨¡å‹
- [x] å®ç°æŠ¥å‘Šç”Ÿæˆé€»è¾‘
- [x] å®ç°æŠ¥å‘Šåˆ†äº«åŠŸèƒ½

### æ¡Œé¢ç«¯ç¨‹åº

#### é¡¹ç›®åˆå§‹åŒ–
- [x] åˆ›å»ºElectron + Reacté¡¹ç›®
- [x] é…ç½®TypeScript
- [x] é…ç½®TailwindCSS + shadcn/ui
- [x] é…ç½®æ„å»ºæ‰“åŒ…ï¼ˆelectron-builderï¼‰

#### é€šä¿¡æ¨¡å—
- [x] å®ç°WebSocketæœåŠ¡å™¨
- [x] å®ç°UDPå¹¿æ’­å‘ç°
- [x] å®ç°ADBè®¾å¤‡æ£€æµ‹
- [x] å®ç°ADBç«¯å£è½¬å‘ç®¡ç†
- [x] å®ç°å¤šè®¾å¤‡è¿æ¥ç®¡ç†

#### æ•°æ®å­˜å‚¨
- [x] å®ç°SQLiteæ•°æ®åº“
- [x] è®¾è®¡æ•°æ®è¡¨ç»“æ„
- [x] å®ç°æ•°æ®CRUDæ“ä½œ
- [x] å®ç°æ•°æ®å¯¼å‡ºåŠŸèƒ½

#### UIå¼€å‘
- [x] è®¾å¤‡è¿æ¥é¢æ¿
- [x] å®æ—¶æ•°æ®ä»ªè¡¨ç›˜
- [x] å¸§ç‡æ›²çº¿å›¾ï¼ˆRechartsï¼‰
- [x] å¸§ç‡åˆ†å¸ƒç›´æ–¹å›¾
- [x] æ€§èƒ½ç»Ÿè®¡å¡ç‰‡
- [x] å†å²ä¼šè¯åˆ—è¡¨
- [x] ä¼šè¯è¯¦æƒ…é¡µ
- [x] å¤šä¼šè¯å¯¹æ¯”é¡µ
- [x] è®¾ç½®é¡µé¢

#### æ•°æ®å¯è§†åŒ–
- [x] å®æ—¶å¸§ç‡æ›²çº¿
- [x] å¸§ç‡åˆ†å¸ƒç›´æ–¹å›¾
- [x] æ¸©åº¦/åŠŸè€—è¶‹åŠ¿å›¾
- [x] å¡é¡¿æ—¶é—´è½´
- [x] æ€§èƒ½é›·è¾¾å›¾

#### æŠ¥å‘Šå¯¼å‡º
- [x] PDFæŠ¥å‘Šç”Ÿæˆ
- [x] Excelæ•°æ®å¯¼å‡º
- [x] å›¾è¡¨å›¾ç‰‡å¯¼å‡º

### æµ‹è¯•ä¸å‘å¸ƒ

#### æµ‹è¯•
- [ ] Androidå•å…ƒæµ‹è¯•
- [ ] æ¡Œé¢ç«¯å•å…ƒæµ‹è¯•
- [ ] ä¼ è¾“ç¨³å®šæ€§æµ‹è¯•
- [ ] å¤šè®¾å¤‡å…¼å®¹æ€§æµ‹è¯•

#### å‘å¸ƒ
- [ ] Android APKç­¾åæ‰“åŒ…
- [ ] æ¡Œé¢ç«¯Windowsæ‰“åŒ…
- [ ] æ¡Œé¢ç«¯macOSæ‰“åŒ…
- [ ] ç¼–å†™ä½¿ç”¨æ–‡æ¡£
- [ ] å½•åˆ¶æ¼”ç¤ºè§†é¢‘

---

## ğŸ”‘ æ ¸å¿ƒæŠ€æœ¯å®ç°

### å¸§ç‡é‡‡é›†ï¼ˆæ— Rootï¼‰

```kotlin
class FpsCollector {
    private var frameCount = 0
    private var lastTime = 0L
    private var currentFps = 0f
    
    private val frameCallback = object : Choreographer.FrameCallback {
        override fun doFrame(frameTimeNanos: Long) {
            val currentTime = System.currentTimeMillis()
            frameCount++
            
            if (currentTime - lastTime >= 1000) {
                currentFps = frameCount * 1000f / (currentTime - lastTime)
                frameCount = 0
                lastTime = currentTime
                onFpsUpdate(currentFps)
            }
            
            Choreographer.getInstance().postFrameCallback(this)
        }
    }
    
    fun start() {
        lastTime = System.currentTimeMillis()
        Choreographer.getInstance().postFrameCallback(frameCallback)
    }
    
    fun stop() {
        Choreographer.getInstance().removeFrameCallback(frameCallback)
    }
}
```

### CPUå ç”¨ç‡é‡‡é›†

```kotlin
class CpuCollector {
    private var lastCpuTime = 0L
    private var lastIdleTime = 0L
    
    fun getCpuUsage(): Float {
        try {
            val reader = BufferedReader(FileReader("/proc/stat"))
            val line = reader.readLine()
            reader.close()
            
            val parts = line.split("\\s+".toRegex())
            val user = parts[1].toLong()
            val nice = parts[2].toLong()
            val system = parts[3].toLong()
            val idle = parts[4].toLong()
            
            val totalTime = user + nice + system + idle
            val cpuTime = user + nice + system
            
            val cpuUsage = if (lastCpuTime > 0) {
                val totalDiff = totalTime - (lastCpuTime + lastIdleTime)
                val cpuDiff = cpuTime - lastCpuTime
                (cpuDiff.toFloat() / totalDiff * 100)
            } else 0f
            
            lastCpuTime = cpuTime
            lastIdleTime = idle
            
            return cpuUsage
        } catch (e: Exception) {
            return -1f
        }
    }
}
```

### WebSocketä¼ è¾“

```kotlin
class PerformanceTransmitter(private val serverUrl: String) {
    private var webSocket: WebSocket? = null
    private val client = OkHttpClient.Builder()
        .readTimeout(0, TimeUnit.MILLISECONDS)
        .build()
    
    private val gson = Gson()
    
    fun connect() {
        val request = Request.Builder()
            .url(serverUrl)
            .build()
        
        webSocket = client.newWebSocket(request, object : WebSocketListener() {
            override fun onOpen(webSocket: WebSocket, response: Response) {
                // è¿æ¥æˆåŠŸ
            }
            
            override fun onFailure(webSocket: WebSocket, t: Throwable, response: Response?) {
                // æ–­çº¿é‡è¿
                Handler(Looper.getMainLooper()).postDelayed({
                    connect()
                }, 3000)
            }
        })
    }
    
    fun sendData(snapshot: PerformanceSnapshot) {
        val packet = PerformancePacket(
            type = "snapshot",
            timestamp = System.currentTimeMillis(),
            deviceId = Build.MODEL,
            data = snapshot
        )
        webSocket?.send(gson.toJson(packet))
    }
}
```

---

## âš ï¸ æŠ€æœ¯é£é™©ä¸è§£å†³æ–¹æ¡ˆ

### é£é™©1: å¸§ç‡é‡‡é›†ç²¾åº¦

**é—®é¢˜**: Choreographeråªèƒ½é‡‡é›†è‡ªèº«åº”ç”¨çš„å¸§ç‡ï¼Œæ— æ³•è·å–å…¶ä»–æ¸¸æˆçš„å¸§ç‡

**è§£å†³æ–¹æ¡ˆ**:
1. ä½¿ç”¨ç³»ç»Ÿçº§dumpsys SurfaceFlingerè·å–
2. ç»“åˆgfxinfoè·å–æ¸²æŸ“æ•°æ®
3. æä¾›ADBæ¨¡å¼ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ

### é£é™©2: æ‚¬æµ®çª—æƒé™

**é—®é¢˜**: Android 10+å¯¹æ‚¬æµ®çª—æƒé™è¦æ±‚æ›´ä¸¥æ ¼

**è§£å†³æ–¹æ¡ˆ**:
1. å¼•å¯¼ç”¨æˆ·å¼€å¯æ‚¬æµ®çª—æƒé™
2. æä¾›æƒé™çŠ¶æ€æ£€æµ‹
3. æ‚¬æµ®çª—å¤±è´¥æ—¶é™çº§åˆ°é€šçŸ¥æ æ˜¾ç¤º

### é£é™©3: ç½‘ç»œä¼ è¾“å»¶è¿Ÿ

**é—®é¢˜**: WiFiä¼ è¾“å¯èƒ½æœ‰å»¶è¿Ÿæˆ–ä¸¢åŒ…

**è§£å†³æ–¹æ¡ˆ**:
1. æœ¬åœ°ç¼“å­˜ä¼˜å…ˆï¼Œæ‰¹é‡ä¼ è¾“
2. æ•°æ®å‹ç¼©å‡å°‘ä¼ è¾“é‡
3. æä¾›USBæœ‰çº¿ä¼ è¾“ä½œä¸ºç¨³å®šæ–¹æ¡ˆ

### é£é™©4: ä¸åŒè®¾å¤‡å…¼å®¹æ€§

**é—®é¢˜**: ä¸åŒå‚å•†è®¾å¤‡çš„APIå¯èƒ½æœ‰å·®å¼‚

**è§£å†³æ–¹æ¡ˆ**:
1. ä½¿ç”¨æ ‡å‡†Android APIä¼˜å…ˆ
2. å‚å•†ç‰¹å®šAPIä½œä¸ºå¢å¼º
3. é‡‡é›†å¤±è´¥æ—¶gracefulé™çº§

---

## ğŸ“Š éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

- [ ] æ‚¬æµ®çª—èƒ½æ­£å¸¸æ˜¾ç¤ºå¸§ç‡æ•°æ®
- [ ] å¸§ç‡æ•°æ®é‡‡é›†å‡†ç¡®ï¼ˆè¯¯å·®<5%ï¼‰
- [ ] CPU/GPU/æ¸©åº¦æ•°æ®æ­£å¸¸è·å–
- [ ] WiFiä¼ è¾“å»¶è¿Ÿ<100ms
- [ ] USBä¼ è¾“æ­£å¸¸å·¥ä½œ
- [ ] æ¡Œé¢ç«¯å®æ—¶æ›²çº¿æµç•…
- [ ] æ•°æ®å­˜å‚¨å’Œå¯¼å‡ºæ­£å¸¸
- [ ] æŠ¥å‘Šç”Ÿæˆå®Œæ•´

### æ€§èƒ½éªŒæ”¶

- [ ] Appè‡ªèº«CPUå ç”¨<5%
- [ ] å†…å­˜å ç”¨<50MB
- [ ] å¯¹æ¸¸æˆå¸§ç‡å½±å“<2fps
- [ ] æ¡Œé¢ç«¯å†…å­˜<300MB

### å…¼å®¹æ€§éªŒæ”¶

- [ ] Android 8.0+
- [ ] Windows 10/11
- [ ] macOS 10.15+

---

## ğŸ“š å‚è€ƒèµ„æ–™

1. [Choreographer](https://developer.android.com/reference/android/view/Choreographer)
2. [System Overlay](https://developer.android.com/reference/android/Manifest.permission#SYSTEM_ALERT_WINDOW)
3. [OkHttp WebSocket](https://square.github.io/okhttp/)
4. [Electron](https://www.electronjs.org/)
5. [Recharts](https://recharts.org/)
6. [ADB Protocol](https://developer.android.com/tools/adb)

---

## ğŸ“ æ›´æ–°æ—¥å¿—

| æ—¥æœŸ       | ç‰ˆæœ¬ | æ›´æ–°å†…å®¹       |
| ---------- | ---- | -------------- |
| 2025-12-27 | v0.1 | åˆå§‹æ–‡æ¡£åˆ›å»º   |
| 2025-01-XX | v1.0 | æ ¸å¿ƒåŠŸèƒ½å¼€å‘å®Œæˆ |

---

**æ–‡æ¡£ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2025å¹´12æœˆ27æ—¥
