# ç½‘ç»œæ€§èƒ½æµ‹è¯•å·¥å…· - å¼€å‘æ–‡æ¡£

> **é¡¹ç›®ç¼–å·**: 09  
> **é¡¹ç›®ç›®å½•**: `apps/network-test`  
> **ä¼˜å…ˆçº§**: P1ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰  
> **çŠ¶æ€**: ğŸŸ¢ å¼€å‘ä¸­ (Web Appå·²å®Œæˆ)  
> **é¢„è®¡å·¥æœŸ**: 2å‘¨  
> **æŠ€æœ¯éš¾åº¦**: â­â­â­â˜†â˜†

---

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

ç½‘ç»œæ€§èƒ½æµ‹è¯•å·¥å…·æ˜¯ä¸€å¥—åŒ…å« **Web App (PWA)** å’Œ **æ¡Œé¢ç«¯å±•ç¤ºç¨‹åº** çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚Web Appè´Ÿè´£æµ‹è¯•ç½‘ç»œæ€§èƒ½æ•°æ®ï¼ˆé€Ÿåº¦ã€å»¶è¿Ÿã€ä¿¡å·å¼ºåº¦ç­‰ï¼‰ï¼Œæ¡Œé¢ç«¯è´Ÿè´£æ¥æ”¶ã€å­˜å‚¨å’Œå¯è§†åŒ–å±•ç¤ºå†å²æ•°æ®ã€‚

### ç³»ç»Ÿæ¶æ„

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      æ— çº¿/æœ‰çº¿ä¼ è¾“      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Web App       â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚    æ¡Œé¢ç«¯ç¨‹åº    â”‚
â”‚  (æ•°æ®é‡‡é›†ç«¯)    â”‚    WebSocket / USB      â”‚   (æ•°æ®å±•ç¤ºç«¯)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒä»·å€¼

1. **å…¨é¢ç½‘ç»œæµ‹è¯•**: 4G/5Gé€Ÿåº¦ã€å»¶è¿Ÿã€æŠ–åŠ¨ã€ä¿¡å·å¼ºåº¦
2. **PWAæ”¯æŒ**: ç¦»çº¿ä½¿ç”¨ã€æ¡Œé¢å¿«æ·æ–¹å¼
3. **æ¡Œé¢ç«¯å¤§å±å±•ç¤º**: ä¸“ä¸šæ•°æ®å¯è§†åŒ–ä¸å†å²å¯¹æ¯”
4. **å¤šç§ä¼ è¾“æ–¹å¼**: æ”¯æŒWiFiæ— çº¿ä¼ è¾“å’ŒUSBæœ‰çº¿ä¼ è¾“

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### Web App

| ç±»åˆ«         | æŠ€æœ¯é€‰å‹              | è¯´æ˜             |
| ------------ | --------------------- | ---------------- |
| **æ¡†æ¶**     | Next.js 14            | Reactå…¨æ ˆæ¡†æ¶    |
| **è¯­è¨€**     | TypeScript            | ç±»å‹å®‰å…¨         |
| **æ ·å¼**     | TailwindCSS           | åŸå­åŒ–CSS        |
| **UIç»„ä»¶**   | shadcn/ui             | ç°ä»£ç»„ä»¶åº“       |
| **å›¾è¡¨**     | Recharts              | æ•°æ®å¯è§†åŒ–       |
| **PWA**      | next-pwa              | ç¦»çº¿æ”¯æŒ         |
| **å­˜å‚¨**     | IndexedDB (Dexie.js)  | æœ¬åœ°æ•°æ®åº“       |
| **éƒ¨ç½²**     | Vercel                | è¾¹ç¼˜éƒ¨ç½²         |

### æ¡Œé¢ç«¯ç¨‹åº

| ç±»åˆ«         | æŠ€æœ¯é€‰å‹              | è¯´æ˜             |
| ------------ | --------------------- | ---------------- |
| **æ¡†æ¶**     | Electron + React      | è·¨å¹³å°æ¡Œé¢åº”ç”¨   |
| **UIåº“**     | TailwindCSS + shadcn  | ç°ä»£UIç»„ä»¶       |
| **å›¾è¡¨**     | Recharts              | æ•°æ®å¯è§†åŒ–       |
| **é€šä¿¡**     | WebSocket             | å®æ—¶æ•°æ®ä¼ è¾“     |
| **æ•°æ®å­˜å‚¨** | SQLite                | æœ¬åœ°æ•°æ®æŒä¹…åŒ–   |
| **åœ°å›¾**     | Leaflet / Mapbox      | ä¿¡å·åœ°å›¾         |

---

## ğŸ¯ åŠŸèƒ½æ¨¡å—

### Web App åŠŸèƒ½

#### 1. é€Ÿåº¦æµ‹è¯•

- **ä¸‹è½½é€Ÿåº¦**: å¤šçº¿ç¨‹ä¸‹è½½æµ‹è¯•
- **ä¸Šä¼ é€Ÿåº¦**: å¤šçº¿ç¨‹ä¸Šä¼ æµ‹è¯•
- **æµ‹è¯•æœåŠ¡å™¨é€‰æ‹©**: è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜èŠ‚ç‚¹
- **æµ‹è¯•è¿›åº¦åŠ¨ç”»**: å®æ—¶æ˜¾ç¤ºæµ‹è¯•çŠ¶æ€

#### 2. å»¶è¿Ÿæµ‹è¯•

- **Pingå»¶è¿Ÿ**: ICMP/HTTPå»¶è¿Ÿæµ‹è¯•
- **æŠ–åŠ¨(Jitter)**: å»¶è¿Ÿç¨³å®šæ€§åˆ†æ
- **ä¸¢åŒ…ç‡**: æ•°æ®åŒ…ä¸¢å¤±æ£€æµ‹
- **å¤šèŠ‚ç‚¹æµ‹è¯•**: ä¸åŒæœåŠ¡å™¨å»¶è¿Ÿå¯¹æ¯”

#### 3. ä¿¡å·ç›‘æ§

- **ç½‘ç»œç±»å‹æ£€æµ‹**: 2G/3G/4G/5G/WiFi
- **ä¿¡å·å¼ºåº¦**: å®æ—¶ä¿¡å·è´¨é‡æ˜¾ç¤º
- **è¿æ¥çŠ¶æ€**: åœ¨çº¿/ç¦»çº¿æ£€æµ‹
- **å¸¦å®½ä¼°ç®—**: æœ‰æ•ˆå¸¦å®½é¢„ä¼°

#### 4. WiFiåˆ†æ

- **WiFiä¿¡æ¯**: SSIDã€é¢‘æ®µã€ä¿¡é“
- **è¿æ¥é€Ÿåº¦**: é“¾è·¯é€Ÿåº¦æ˜¾ç¤º
- **ä¿¡å·å†å²**: ä¿¡å·å¼ºåº¦å˜åŒ–æ›²çº¿

#### 5. æ•°æ®è®°å½•

- **æµ‹è¯•å†å²**: æœ¬åœ°å­˜å‚¨æµ‹è¯•è®°å½•
- **ä½ç½®æ ‡è®°**: è®°å½•æµ‹è¯•åœ°ç‚¹
- **æ•°æ®å¯¼å‡º**: JSON/CSVå¯¼å‡º
- **åŒæ­¥åˆ°æ¡Œé¢ç«¯**: å®æ—¶/æ‰¹é‡ä¼ è¾“

#### 6. ä¿¡å·åœ°å›¾

- **åœ°å›¾æ ‡è®°**: åœ¨åœ°å›¾ä¸Šæ ‡è®°æµ‹è¯•ç‚¹
- **çƒ­åŠ›å›¾**: ä¿¡å·å¼ºåº¦åˆ†å¸ƒå›¾
- **å†å²è½¨è¿¹**: æµ‹è¯•è·¯å¾„å±•ç¤º

### æ¡Œé¢ç«¯åŠŸèƒ½

#### 1. è®¾å¤‡è¿æ¥

- è‡ªåŠ¨å‘ç°å±€åŸŸç½‘Web App
- USBè®¾å¤‡æ£€æµ‹
- è¿æ¥çŠ¶æ€ç›‘æ§
- å¤šè®¾å¤‡æ”¯æŒ

#### 2. å®æ—¶æ•°æ®å±•ç¤º

- å¤§å±å®æ—¶ç½‘ç»œçŠ¶æ€
- é€Ÿåº¦/å»¶è¿Ÿæ›²çº¿å›¾
- ä¿¡å·å¼ºåº¦ä»ªè¡¨ç›˜
- å®æ—¶ç»Ÿè®¡é¢æ¿

#### 3. å†å²æ•°æ®ç®¡ç†

- æµ‹è¯•è®°å½•åˆ—è¡¨
- æ•°æ®ç­›é€‰è¿‡æ»¤
- å¤šè®°å½•å¯¹æ¯”åˆ†æ

#### 4. ä¿¡å·åœ°å›¾

- å…¨å±åœ°å›¾å±•ç¤º
- ä¿¡å·çƒ­åŠ›å›¾
- æµ‹è¯•ç‚¹è¯¦æƒ…æŸ¥çœ‹
- åŒºåŸŸä¿¡å·åˆ†æ

#### 5. æŠ¥å‘Šå¯¼å‡º

- PDFæŠ¥å‘Šç”Ÿæˆ
- Excelæ•°æ®å¯¼å‡º
- å›¾è¡¨å›¾ç‰‡å¯¼å‡º

---

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

### Web App

```text
apps/network-test/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ page.tsx
â”‚   â”œâ”€â”€ speed/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ latency/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ signal/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ map/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ history/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â””â”€â”€ settings/
â”‚       â””â”€â”€ page.tsx
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ speed-test/
â”‚   â”‚   â”œâ”€â”€ SpeedGauge.tsx
â”‚   â”‚   â”œâ”€â”€ SpeedChart.tsx
â”‚   â”‚   â””â”€â”€ TestProgress.tsx
â”‚   â”œâ”€â”€ latency/
â”‚   â”‚   â”œâ”€â”€ PingDisplay.tsx
â”‚   â”‚   â””â”€â”€ JitterChart.tsx
â”‚   â”œâ”€â”€ signal/
â”‚   â”‚   â”œâ”€â”€ SignalStrength.tsx
â”‚   â”‚   â””â”€â”€ NetworkType.tsx
â”‚   â”œâ”€â”€ map/
â”‚   â”‚   â”œâ”€â”€ SignalMap.tsx
â”‚   â”‚   â””â”€â”€ HeatmapLayer.tsx
â”‚   â””â”€â”€ sync/
â”‚       â””â”€â”€ SyncPanel.tsx
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ speed-test.ts
â”‚   â”œâ”€â”€ latency-test.ts
â”‚   â”œâ”€â”€ network-info.ts
â”‚   â”œâ”€â”€ database.ts
â”‚   â””â”€â”€ websocket.ts
â”‚
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useSpeedTest.ts
â”‚   â”œâ”€â”€ useNetworkInfo.ts
â”‚   â””â”€â”€ useSync.ts
â”‚
â”œâ”€â”€ public/
â”‚   â””â”€â”€ manifest.json
â”‚
â”œâ”€â”€ next.config.js
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

### æ¡Œé¢ç«¯

```text
apps/network-test/
â”œâ”€â”€ desktop/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ websocket.ts
â”‚   â”‚   â”‚   â””â”€â”€ database.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ renderer/
â”‚   â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DevicePanel.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SpeedChart.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LatencyChart.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SignalMap.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ HistoryList.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Map.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ History.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Settings.tsx
â”‚   â”‚   â”‚   â””â”€â”€ hooks/
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ preload/
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ electron-builder.json
```

---

## ğŸ“¡ æ•°æ®ä¼ è¾“åè®®

### WebSocketåè®®ï¼ˆæ— çº¿ä¼ è¾“ï¼‰

```typescript
// è¿æ¥: ws://desktop_ip:8766

interface NetworkPacket {
  type: 'speed_result' | 'latency_result' | 'signal_update' | 'sync_history';
  timestamp: number;
  deviceId: string;
  data: SpeedResult | LatencyResult | SignalData | HistoryData[];
}

interface SpeedResult {
  downloadSpeed: number;  // Mbps
  uploadSpeed: number;    // Mbps
  testDuration: number;   // ms
  serverLocation: string;
  networkType: string;
}

interface LatencyResult {
  ping: number;           // ms
  jitter: number;         // ms
  packetLoss: number;     // ç™¾åˆ†æ¯”
  hops: number;
}

interface SignalData {
  networkType: '2g' | '3g' | '4g' | '5g' | 'wifi';
  signalStrength: number; // dBm or 0-100
  bandwidth: number;      // Mbps
  location?: {
    lat: number;
    lng: number;
  };
}
```

### USBä¼ è¾“

```text
é€šè¿‡æœ¬åœ°HTTPæœåŠ¡å™¨å®ç°:
1. æ¡Œé¢ç«¯å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ localhost:8766
2. æ‰‹æœºé€šè¿‡USBç½‘ç»œå…±äº«è¿æ¥ç”µè„‘
3. Web App è¿æ¥ localhost:8766 è¿›è¡Œæ•°æ®ä¼ è¾“
```

---

## ğŸ“‹ å¼€å‘ä»»åŠ¡æ¸…å• (TODO List)

### Web App

#### é¡¹ç›®åˆå§‹åŒ–

- [x] åˆ›å»ºNext.jsé¡¹ç›®
- [x] é…ç½®TypeScript
- [x] é…ç½®TailwindCSS + shadcn/ui
- [x] é…ç½®PWA (next-pwa)
- [x] é…ç½®IndexedDB (Dexie.js)

#### é€Ÿåº¦æµ‹è¯•æ¨¡å—

- [x] å®ç°ä¸‹è½½é€Ÿåº¦æµ‹è¯•ç®—æ³•
- [x] å®ç°ä¸Šä¼ é€Ÿåº¦æµ‹è¯•ç®—æ³•
- [x] å®ç°æµ‹è¯•æœåŠ¡å™¨é€‰æ‹©
- [x] å®ç°å¤šçº¿ç¨‹å¹¶å‘æµ‹è¯•
- [x] è®¾è®¡é€Ÿåº¦ä»ªè¡¨ç›˜UI
- [x] å®ç°æµ‹è¯•è¿›åº¦åŠ¨ç”»
- [x] å®ç°ç»“æœå±•ç¤ºé¡µé¢

#### å»¶è¿Ÿæµ‹è¯•æ¨¡å—

- [x] å®ç°HTTP Pingæµ‹è¯•
- [x] å®ç°æŠ–åŠ¨(Jitter)è®¡ç®—
- [x] å®ç°ä¸¢åŒ…ç‡æ£€æµ‹
- [x] å®ç°å¤šèŠ‚ç‚¹å»¶è¿Ÿæµ‹è¯•
- [x] è®¾è®¡å»¶è¿Ÿå±•ç¤ºUI

#### ä¿¡å·ç›‘æ§æ¨¡å—

- [x] å®ç°Network Information API
- [x] å®ç°ç½‘ç»œç±»å‹æ£€æµ‹
- [x] å®ç°ä¿¡å·å¼ºåº¦è·å–
- [x] å®ç°è¿æ¥çŠ¶æ€ç›‘å¬
- [x] å®ç°å¸¦å®½ä¼°ç®—
- [x] è®¾è®¡ä¿¡å·ç›‘æ§UI

#### åœ°å›¾åŠŸèƒ½

- [x] é›†æˆLeafletåœ°å›¾
- [x] å®ç°ä½ç½®è·å–(Geolocation)
- [x] å®ç°æµ‹è¯•ç‚¹æ ‡è®°
- [ ] å®ç°ä¿¡å·çƒ­åŠ›å›¾
- [ ] å®ç°å†å²è½¨è¿¹å±•ç¤º

#### æ•°æ®å­˜å‚¨

- [x] è®¾è®¡IndexedDB Schema
- [x] å®ç°æµ‹è¯•è®°å½•CRUD
- [x] å®ç°æ•°æ®å¯¼å‡ºåŠŸèƒ½
- [x] å®ç°æ•°æ®æ¸…ç†åŠŸèƒ½

#### æ•°æ®åŒæ­¥

- [x] å®ç°WebSocketå®¢æˆ·ç«¯
- [x] å®ç°è‡ªåŠ¨å‘ç°æ¡Œé¢ç«¯
- [x] å®ç°å®æ—¶æ•°æ®æ¨é€
- [x] å®ç°æ‰¹é‡å†å²åŒæ­¥
- [x] å®ç°æ–­çº¿é‡è¿

#### UIé¡µé¢

- [x] é¦–é¡µ(å¿«é€Ÿæµ‹è¯•å…¥å£)
- [x] é€Ÿåº¦æµ‹è¯•é¡µ
- [x] å»¶è¿Ÿæµ‹è¯•é¡µ
- [x] ä¿¡å·ç›‘æ§é¡µ
- [x] åœ°å›¾é¡µ
- [x] å†å²è®°å½•é¡µ
- [x] è®¾ç½®é¡µ

### æ¡Œé¢ç«¯ç¨‹åº

#### é¡¹ç›®åˆå§‹åŒ–

- [ ] åˆ›å»ºElectron + Reacté¡¹ç›®
- [ ] é…ç½®TypeScript
- [ ] é…ç½®TailwindCSS + shadcn/ui
- [ ] é…ç½®electron-builder

#### é€šä¿¡æ¨¡å—

- [ ] å®ç°WebSocketæœåŠ¡å™¨
- [ ] å®ç°UDPå¹¿æ’­å‘ç°
- [ ] å®ç°USBè¿æ¥æ£€æµ‹
- [ ] å®ç°å¤šè®¾å¤‡ç®¡ç†

#### æ•°æ®å­˜å‚¨

- [ ] å®ç°SQLiteæ•°æ®åº“
- [ ] è®¾è®¡æ•°æ®è¡¨ç»“æ„
- [ ] å®ç°æ•°æ®CRUD
- [ ] å®ç°æ•°æ®å¯¼å‡º

#### UIå¼€å‘

- [ ] è®¾å¤‡è¿æ¥é¢æ¿
- [ ] å®æ—¶æ•°æ®ä»ªè¡¨ç›˜
- [ ] é€Ÿåº¦æ›²çº¿å›¾
- [ ] å»¶è¿Ÿæ›²çº¿å›¾
- [ ] ä¿¡å·å¼ºåº¦å›¾è¡¨
- [ ] å†å²è®°å½•åˆ—è¡¨
- [ ] è®°å½•è¯¦æƒ…é¡µ
- [ ] å¤šè®°å½•å¯¹æ¯”é¡µ
- [ ] è®¾ç½®é¡µé¢

#### åœ°å›¾åŠŸèƒ½

- [ ] é›†æˆLeafletåœ°å›¾
- [ ] å®ç°ä¿¡å·çƒ­åŠ›å›¾
- [ ] å®ç°æµ‹è¯•ç‚¹å±•ç¤º
- [ ] å®ç°åŒºåŸŸåˆ†æ

#### æŠ¥å‘Šå¯¼å‡º

- [ ] PDFæŠ¥å‘Šç”Ÿæˆ
- [ ] Excelæ•°æ®å¯¼å‡º
- [ ] å›¾è¡¨å›¾ç‰‡å¯¼å‡º

### æµ‹è¯•ä¸å‘å¸ƒ

#### æµ‹è¯•

- [ ] Web AppåŠŸèƒ½æµ‹è¯•
- [ ] æ¡Œé¢ç«¯åŠŸèƒ½æµ‹è¯•
- [ ] ä¼ è¾“ç¨³å®šæ€§æµ‹è¯•
- [ ] PWAç¦»çº¿æµ‹è¯•
- [ ] å¤šæµè§ˆå™¨å…¼å®¹æµ‹è¯•

#### å‘å¸ƒ

- [ ] Verceléƒ¨ç½²Web App
- [ ] æ¡Œé¢ç«¯Windowsæ‰“åŒ…
- [ ] æ¡Œé¢ç«¯macOSæ‰“åŒ…
- [ ] ç¼–å†™ä½¿ç”¨æ–‡æ¡£

---

## ğŸ”‘ æ ¸å¿ƒæŠ€æœ¯å®ç°

### é€Ÿåº¦æµ‹è¯•

```typescript
class SpeedTester {
  private testServers = [
    'https://speed1.example.com/download',
    'https://speed2.example.com/download',
  ];

  async testDownload(): Promise<number> {
    const testSize = 10 * 1024 * 1024; // 10MB
    const startTime = performance.now();
    
    const response = await fetch(this.testServers[0], {
      method: 'GET',
      cache: 'no-store',
    });
    
    const reader = response.body?.getReader();
    let receivedBytes = 0;
    
    while (true) {
      const { done, value } = await reader!.read();
      if (done) break;
      receivedBytes += value.length;
    }
    
    const duration = (performance.now() - startTime) / 1000;
    const speedMbps = (receivedBytes * 8) / (duration * 1000000);
    
    return speedMbps;
  }

  async testUpload(): Promise<number> {
    const testData = new Blob([new ArrayBuffer(5 * 1024 * 1024)]); // 5MB
    const startTime = performance.now();
    
    await fetch('https://speed.example.com/upload', {
      method: 'POST',
      body: testData,
    });
    
    const duration = (performance.now() - startTime) / 1000;
    const speedMbps = (testData.size * 8) / (duration * 1000000);
    
    return speedMbps;
  }
}
```

### å»¶è¿Ÿæµ‹è¯•

```typescript
class LatencyTester {
  async measurePing(url: string, count: number = 10): Promise<{
    avg: number;
    min: number;
    max: number;
    jitter: number;
  }> {
    const results: number[] = [];
    
    for (let i = 0; i < count; i++) {
      const start = performance.now();
      await fetch(url, { method: 'HEAD', cache: 'no-store' });
      const latency = performance.now() - start;
      results.push(latency);
      await new Promise(r => setTimeout(r, 100));
    }
    
    const avg = results.reduce((a, b) => a + b) / results.length;
    const min = Math.min(...results);
    const max = Math.max(...results);
    
    // è®¡ç®—æŠ–åŠ¨ (æ ‡å‡†å·®)
    const variance = results.reduce((sum, val) => 
      sum + Math.pow(val - avg, 2), 0) / results.length;
    const jitter = Math.sqrt(variance);
    
    return { avg, min, max, jitter };
  }
}
```

### ç½‘ç»œä¿¡æ¯è·å–

```typescript
function getNetworkInfo(): NetworkInfo {
  const connection = (navigator as any).connection || 
                     (navigator as any).mozConnection || 
                     (navigator as any).webkitConnection;
  
  if (connection) {
    return {
      type: connection.effectiveType, // 4g, 3g, 2g, slow-2g
      downlink: connection.downlink,  // Mbps
      rtt: connection.rtt,            // ms
      saveData: connection.saveData,
    };
  }
  
  return { type: 'unknown', downlink: 0, rtt: 0, saveData: false };
}

// ç›‘å¬ç½‘ç»œå˜åŒ–
function watchNetwork(callback: (info: NetworkInfo) => void) {
  const connection = (navigator as any).connection;
  if (connection) {
    connection.addEventListener('change', () => {
      callback(getNetworkInfo());
    });
  }
}
```

### WebSocketåŒæ­¥

```typescript
class SyncClient {
  private ws: WebSocket | null = null;
  private serverUrl: string = '';
  
  async discoverServer(): Promise<string | null> {
    // é€šè¿‡UDPå¹¿æ’­å‘ç°æ¡Œé¢ç«¯æœåŠ¡å™¨
    // åœ¨Webç¯å¢ƒä¸­ä½¿ç”¨HTTPè½®è¯¢æ›¿ä»£
    const possibleHosts = [
      'ws://localhost:8766',
      'ws://192.168.1.100:8766',
    ];
    
    for (const host of possibleHosts) {
      try {
        const ws = new WebSocket(host);
        await new Promise((resolve, reject) => {
          ws.onopen = resolve;
          ws.onerror = reject;
          setTimeout(reject, 1000);
        });
        ws.close();
        return host;
      } catch {
        continue;
      }
    }
    return null;
  }
  
  connect(url: string) {
    this.ws = new WebSocket(url);
    this.ws.onclose = () => {
      setTimeout(() => this.connect(url), 3000);
    };
  }
  
  send(data: NetworkPacket) {
    if (this.ws?.readyState === WebSocket.OPEN) {
      this.ws.send(JSON.stringify(data));
    }
  }
}
```

---

## âš ï¸ æŠ€æœ¯é£é™©ä¸è§£å†³æ–¹æ¡ˆ

### é£é™©1: æµè§ˆå™¨APIé™åˆ¶

**é—®é¢˜**: æµè§ˆå™¨æ— æ³•è·å–çœŸå®çš„ä¿¡å·å¼ºåº¦å’ŒåŸºç«™ä¿¡æ¯

**è§£å†³æ–¹æ¡ˆ**:
1. ä½¿ç”¨Network Information APIè·å–å¯ç”¨ä¿¡æ¯
2. é€šè¿‡é€Ÿåº¦æµ‹è¯•é—´æ¥è¯„ä¼°ç½‘ç»œè´¨é‡
3. æä¾›PWAå®‰è£…ä»¥è·å–æ›´å¤šæƒé™

### é£é™©2: é€Ÿåº¦æµ‹è¯•å‡†ç¡®æ€§

**é—®é¢˜**: æµ‹è¯•æœåŠ¡å™¨è·ç¦»ã€ç½‘ç»œæ‹¥å¡å½±å“ç»“æœ

**è§£å†³æ–¹æ¡ˆ**:
1. å¤šæœåŠ¡å™¨æµ‹è¯•å–å¹³å‡
2. è‡ªåŠ¨é€‰æ‹©æœ€è¿‘çš„æµ‹è¯•èŠ‚ç‚¹
3. å¤šæ¬¡æµ‹è¯•å–ä¸­ä½æ•°

### é£é™©3: è·¨åŸŸé™åˆ¶

**é—®é¢˜**: æµ‹è¯•æœåŠ¡å™¨éœ€è¦é…ç½®CORS

**è§£å†³æ–¹æ¡ˆ**:
1. è‡ªå»ºæµ‹è¯•æœåŠ¡å™¨é…ç½®CORS
2. ä½¿ç”¨ä»£ç†æœåŠ¡å™¨
3. ä½¿ç”¨æ”¯æŒCORSçš„å…¬å…±æµ‹é€ŸæœåŠ¡

### é£é™©4: PWAç¦»çº¿åŠŸèƒ½

**é—®é¢˜**: ç¦»çº¿æ—¶æ— æ³•è¿›è¡Œç½‘ç»œæµ‹è¯•

**è§£å†³æ–¹æ¡ˆ**:
1. ç¼“å­˜å†å²æ•°æ®ä¾›ç¦»çº¿æŸ¥çœ‹
2. ç¦»çº¿æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å†å²æ¨¡å¼
3. æ¢å¤ç½‘ç»œåè‡ªåŠ¨åŒæ­¥

---

## ğŸ“Š éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

- [ ] é€Ÿåº¦æµ‹è¯•ç»“æœå‡†ç¡®ï¼ˆè¯¯å·®<15%ï¼‰
- [ ] å»¶è¿Ÿæµ‹è¯•ç»“æœç¨³å®š
- [ ] ç½‘ç»œç±»å‹æ£€æµ‹æ­£ç¡®
- [ ] åœ°å›¾åŠŸèƒ½æ­£å¸¸æ˜¾ç¤º
- [ ] æ•°æ®åŒæ­¥å»¶è¿Ÿ<500ms
- [ ] PWAç¦»çº¿æ­£å¸¸å·¥ä½œ
- [ ] æ¡Œé¢ç«¯æ•°æ®å±•ç¤ºæ­£ç¡®

### æ€§èƒ½éªŒæ”¶

- [ ] é¦–å±åŠ è½½<3s
- [ ] æµ‹è¯•è¿‡ç¨‹æµç•…
- [ ] åœ°å›¾æ¸²æŸ“æµç•…
- [ ] æ¡Œé¢ç«¯å†…å­˜<300MB

### å…¼å®¹æ€§éªŒæ”¶

- [ ] Chrome/Edge/Firefox/Safari
- [ ] iOS Safari / Android Chrome
- [ ] Windows 10/11
- [ ] macOS 10.15+

---

## ğŸ“š å‚è€ƒèµ„æ–™

1. [Network Information API](https://developer.mozilla.org/en-US/docs/Web/API/Network_Information_API)
2. [Geolocation API](https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API)
3. [Service Workers](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API)
4. [Leaflet](https://leafletjs.com/)
5. [Dexie.js](https://dexie.org/)
6. [Next.js PWA](https://github.com/shadowwalker/next-pwa)

---

## ğŸ“ æ›´æ–°æ—¥å¿—

| æ—¥æœŸ       | ç‰ˆæœ¬ | æ›´æ–°å†…å®¹       |
| ---------- | ---- | -------------- |
| 2025-12-27 | v0.1 | åˆå§‹æ–‡æ¡£åˆ›å»º   |

---

**æ–‡æ¡£ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2025å¹´12æœˆ27æ—¥
